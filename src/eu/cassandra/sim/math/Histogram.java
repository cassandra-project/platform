/*   
   Copyright 2011-2013 The Cassandra Consortium (cassandra-fp7.eu)


   Licensed under the Apache License, Version 2.0 (the "License");
   you may not use this file except in compliance with the License.
   You may obtain a copy of the License at

       http://www.apache.org/licenses/LICENSE-2.0

   Unless required by applicable law or agreed to in writing, software
   distributed under the License is distributed on an "AS IS" BASIS,
   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   See the License for the specific language governing permissions and
   limitations under the License.
*/
package eu.cassandra.sim.math;

import eu.cassandra.sim.utilities.RNG;

public class Histogram implements ProbabilityDistribution{

	protected int numberOfBins;
	  protected double precomputeFrom;
	  protected double precomputeTo;
	  protected double[] histogram;
	  protected boolean precomputed;
	
	public Histogram(int size){
		
		precomputeFrom = 0;
		precomputeTo = size;
		numberOfBins = size;
		histogram = new double[size];
		precomputed = false;
	}
	
	/**
	  * Constructor. Takes a set of values and put them in the histogram.
	  */
	public Histogram(double[] values){
		
		precomputeFrom = 0;
		precomputeTo = values.length;
		numberOfBins = values.length;
		histogram = values;
		precomputed = true;
		
	}

	@Override
	public String getDescription() {
		String description = "Histogram Frequency Probability Density function";
	    return description;
	}

	@Override
	public int getNumberOfParameters() {
		return 1;
	}

	@Override
	public double getParameter(int index) {
		return numberOfBins;
	}

	@Override
	public void setParameter(int index, double value) {
		// TODO Auto-generated method stub
		
	}

	@Override
	public void precompute(double startValue, double endValue, int nBins) {
		// TODO Auto-generated method stub
		
	}

	@Override
	public void precompute(int endValue) {
		// TODO Auto-generated method stub
		
	}

	@Override
	public double getProbability(double x) {
		return histogram[(int)x];
	}

	@Override
	public double getPrecomputedProbability(double x) {
		return histogram[(int)x];
	}

	@Override
	public int getPrecomputedBin ()
	  {
	    if (!precomputed) {
	      return -1;
	    }
	    // double div = (precomputeTo - precomputeFrom) / (double) numberOfBins;
	    double dice = RNG.nextDouble();
	    double sum = 0;
	    for (int i = 0; i < numberOfBins; i++) {
	      sum += histogram[i];
	      // if(dice < sum) return (int)(precomputeFrom + i * div);
	      if (dice < sum)
	        return i;
	    }
	    return -1;
	  }

	@Override
	public double[] getHistogram() {
		
		return histogram;
	}

	@Override
	public void status() {
		System.out.print("Histogram");
	    System.out.print(" Number Of Bins: " + getParameter(0));
	    if (precomputed) {
	      System.out.print(" Starting Point: " + precomputeFrom);
	      System.out.println(" Ending Point: " + precomputeTo);
	    }
	    
	    for (int i = 0; i < histogram.length;i++){
	    	System.out.println("Index: " + i + " Value: " + histogram[i]);
	    }
	    System.out.println();
	}

	/**
	 * @param args
	 */
	public static void main(String[] args) {
		double[] values = {0.0007558164210056985,0.0007668303424379452,0.0007780826093792164,0.00078957267253962,0.0008012996711968562,0.0008132624291651606,0.0008254594461887634,0.0008380616954192309,0.0008505164266917385,0.0008634095024854162,0.0008765265776331068,0.0008898645837494817,0.0009034200763853411,0.0009171892365498503,0.000931167864812115,0.0009453513863380649,0.0009599672091195356,0.0009742686543303669,0.0009890434293156408,0.0010039996904847737,0.0010191311371676843,0.0010344310728878446,0.0010498923928368524,0.0010655075993547506,0.001081268795907532,0.00109751066459012,0.001113128827431204,0.0011292889196470224,0.001145557655674161,0.001161925580669756,0.00117838283664301,0.001194919221615926,0.0012115241508911599,0.0012281867041364174,0.0012448956038362238,0.0012616392926298127,0.001278765682698177,0.0012951082636036484,0.0013118982743974162,0.0013286713687759978,0.001345415015017069,0.001362116356851513,0.001378762370022699,0.0013953397460703444,0.0014118350055428264,0.001428234422484513,0.0014450465137143854,0.0014605748798910301,0.0014766267637759164,0.0014925226172391136,0.001508248869176888,0.0015237918952282655,0.0015391378239353495,0.0015542729715016885,0.0015691834524128694,0.0015838554834830855,0.001598275104044532,0.0016124287583950676,0.001626793091465615,0.0016397583420009033,0.0016530615362021041,0.0016660391670576967,0.0016786792263666977,0.0016909699830840927,0.001702899412543483,0.0017144563267895332,0.0017256292700980806,0.0017364073006173012,0.0017467791464759895,0.0017573194643022514,0.0017660817089926455,0.0017752254876938908,0.0017839109157686188,0.0017921321932608692,0.0017998826201720663,0.001807156230790996,0.001813945933243867,0.0018202469947919927,0.0018260534972951627,0.0018313607511366114,0.0018365728402706643,0.0018402547152754289,0.001844123324761173,0.0018474434662855488,0.0018502220410218928,0.0018524626057036266,0.0018541717657689183,0.0018554835566659267,0.0018558769088364664,0.0018559010104643287,0.0018559825257170367,0.0018548296247686746,0.0018533892387773635,0.0018514234918006374,0.0018489255911261673,0.0018458959032854085,0.0018423283104945106,0.0018390469364408008,0.0018341180819254697,0.001829169621244922,0.001823742129344974,0.0018178429250756342,0.0018114824195726812,0.0018046600656151926,0.0017973935047529335,0.001789688030007257,0.0017815525075366998,0.0017729997123367336,0.001764917495683759,0.001755006830616362,0.0017453531053033338,0.0017353420197269596,0.0017249927374555086,0.0017143023989455843,0.001703303872159631,0.0016920053946556516,0.0016804221163236304,0.001668577266301568,0.001656461390898047,0.0016448056445420088,0.0016317667289973128,0.0016190510516720417,0.0016061693417958774,0.0015931017952002283,0.0015799073514705304,0.0015665898082398125,0.001553167801239326,0.0015396600790735483,0.0015261004426143762,0.0015124599651974292,0.0014993570202887615,0.001485297613483023,0.0014716803282566657,0.0014580975092099782,0.0014445885418272473,0.0014311107072763826,0.0014177508207620156,0.0014045043687373325,0.001391390982794974,0.0013784631316718708,0.0013656349964303435,0.001353511046906021,0.001340769563663943,0.0013286374809188535,0.0013167575321182078,0.0013051954011683098,0.0012938208653565325,0.0012828120527372808,0.0012721296546266039,0.0012617916787400739,0.0012518157901729163,0.001242577055877008,0.0012331596131846996,0.0012243234499395258,0.0012159883690324612,0.0012081014636910554,0.0012006785969564421,0.0011937351725761218,0.0011873732578915966,0.0011813292101438067,0.001175914959333955,0.0011713342386903845,0.001166773925872153,0.001163019012436249,0.0011598395773879107,0.001157362928756918,0.0011552304385496943,0.0011538486368652175,0.0011530842756086494,0.0011529466160512438,0.0011536643432918377,0.0011546332409263726,0.0011565967910108902,0.001158860447904006,0.0011619889567851152,0.0011657857212895863,0.0011702551547584374,0.0011754011019282243,0.0011812264330774743,0.0011879095963573943,0.0011951587048718599,0.0012028015091225797,0.001211372771130727,0.0012206255350763375,0.0012305579693593853,0.0012411673930021391,0.0012524499448623762,0.0012645259913108046,0.0012773001110821306,0.0012902667083623787,0.0013042031318388275,0.0013187796240627244,0.0013339875908954303,0.001349817063027086,0.001366257341963681,0.0013833903775112724,0.001401305353622789,0.0014190675647038201,0.0014378413392819804,0.0014571554909134667,0.001476993275314644,0.0014973383168358399,0.0015181723328972364,0.001539551805818539,0.0015612465473160018,0.0015838804523240367,0.001605931816000049,0.0016289309786357354,0.00165228910111085,0.0016759826567280833,0.0017000402551330656,0.001724288709804006,0.0017488412220387573,0.0017736272986963216,0.0017992259138798188,0.001823655680283787,0.0018490029659237758,0.001874504749870742,0.0019000240134596968,0.0019256323913488934,0.001951269025897632,0.0019769008954625684,0.002002500038541056,0.0020280586796089014,0.002054181433268664,0.0020786188255450507,0.0021038089681228622,0.002128797835417836,0.0021535584652769978,0.0021780587416783594,0.0022022872228297866,0.0022261604879051673,0.002249693097456924,0.0022728442304317024,0.002295581315735693,0.002318518872080118,0.002339526516712323,0.002360879419809672,0.002381695583941355,0.002401945815574854,0.0024216012406650233,0.0024406362736548123,0.0024590352624923014,0.0024767508145698077,0.0024937730836429254,0.0025108482107076458,0.002525392851733458,0.0025402824693190203,0.0025543772614935343,0.002567648196160744,0.00258008348683855,0.002591679980583541,0.0026024184803401886,0.002612286333446664,0.0026222836397642754,0.0026288785744968133,0.0026362820320959194,0.0026426846355543537,0.002648119795158682,0.002652594657537049,0.002656109115414746,0.00265906860190401,0.002659926393694806,0.002660710789958122,0.0026610273933299344,0.0026595528834115934,0.0026574186832014615,0.0026543349623953092,0.0026502939403631274,0.0026452984152440214,0.0026392988284934193,0.0026340160229388213,0.002625506769816985,0.002617066420686248,0.0026077659800074664,0.0025976202808789977,0.0025866575697673813,0.0025748407460010458,0.002562242489209776,0.0025488575136316145,0.0025357889207552452,0.0025202788438178237,0.002504802366239861,0.002488674513446458,0.0024718399146527203,0.0024544087450865024,0.0024363747006714833,0.0024177654070273876,0.0023986067076678793,0.0023789255908649317,0.0023587477553315057,0.002339289622740987,0.0023173992633479393,0.002296006634928625,0.002274250370455318,0.002252160233147663,0.0022297675088445938,0.0022071025799981457,0.002184246540207835,0.0021610696704319594,0.002137771302404594,0.0021152156885528056,0.0020910152691165558,0.0020674173531495445,0.0020437682832950234,0.0020200984386337106,0.001996508283079943,0.001972802159818508,0.0019492469831809745,0.0019257854147738647,0.001902444989758389,0.0018800073146014134,0.0018564375914401892,0.0018336643722333223,0.0018111228073752577,0.001788925402810698,0.0017668165751459992,0.0017451153561087464,0.0017237380527192387,0.0017027055400136192,0.0016825900230696814,0.0016618965090229383,0.0016420464664852624,0.0016226211427649699,0.0016037540637071966,0.0015850904215583901,0.0015670382804720345,0.0015494709117626195,0.0015324009675948185,0.0015162852135712243,0.0014999082731004553,0.0014844194040176501,0.0014694720299440935,0.0014552406460077475,0.0014412035315809967,0.0014279279682994192,0.001415218487614372,0.001403392884976244,0.0013915880451301874,0.0013806120131262597,0.0013702143316167098,0.0013603954006361793,0.0013511541808651254,0.0013427034180561234,0.001334361257003349,0.0013270877228590073,0.0013199563144286933,0.0013135809143132017,0.001307762901732253,0.001302495474283214,0.0012977722929330311,0.0012935854438079445,0.0012899265132146726,0.001286983817121695,0.001284447699185075,0.0012820337423543235,0.0012804086301658362,0.001279259996093223,0.0012785769501759473,0.0012783470032049482,0.0012786973228820424,0.001279227643508955,0.0012802857602782968,0.001281745051217787,0.00128359013144264,0.0012861174654802666,0.0012883221866403054,0.0012913543928375038,0.001294525258574208,0.0012980912803498238,0.0013019522875080387,0.001306090745331392,0.0013104925064654882,0.0013152084194415642,0.0013200351891127472,0.0013251311242598433,0.0013308579112876816,0.0013358118864651785,0.0013414707610271267,0.0013472741891773484,0.00135326505353133,0.0013592705606835156,0.0013654204997420026,0.0013716534360654767,0.0013779536389408433,0.0013843054786118246,0.0013907343098272125,0.0013971112889617397,0.0014035275895501595,0.0014103389063826347,0.001416221805458175,0.0030382909141052324,0.0030446294544746533,0.0030508462561136835,0.0030570053665227555,0.0030630653293797104,0.0030690184707700676,0.003074868706252249,0.0030805537795865357,0.00308610856147742,0.0030915068886597855,0.0030972024863507065,0.0031016556810341094,0.0031065661413864597,0.0031112466799789436,0.0031157234827947464,0.003119976886737746,0.0031239990396010157,0.0031277918362663925,0.0031313216827693943,0.00313460601015041,0.0031376334565630286,0.003140911925088785,0.00314265442958034,0.0031449428112823525,0.0031469262375690378,0.00314860083613726,0.0031499675922278874,0.0031510316562555316,0.0019867357538994926,0.0017549302999240156,0.0001391768186201047,0.00013918346359672877,0.00013906367914082927,0.00013909879790201268,0.00013889040333147433,0.0001387119453251041,0.00013849329902066793,0.00013823428400953816,0.00013793426099965945,0.00013759112822613585,0.00013728553059821671,0.00013682835154479308,0.00013637912328123193,0.00013589149105050098,0.00013536637444921086,0.0001348039496992337,0.00013420474865163303,0.00013356986422198856,0.00013289674779424156,0.0001321892278830785,0.00013144655202722635,0.00013066930941550435,0.00012994836434884082,0.00012904518456032627,0.00012817621453320904,0.0001272767083337211,0.0001263472827966223,0.00012539040042268876,0.0001244023971695234,0.00012338886189725446,0.0001223489332317034,0.00012128364584977001,0.00012019388178557477,0.0001190806018420331,0.00011801683904433263,0.00011680776148357535,0.00011563442356435973,0.00011444427294617821,0.0001132321265511928,0.00011200558552650233,0.00011076346649913236,0.00010950687523464849,0.00010823686004603996,0.0001069545488938797,0.0001056610142498781,0.00010435734578849382,0.00010310330527375653,0.00010174137988407099,0.00010041361104740716,0.00009908374707814627,0.0000977496108687517,0.00009641231291294136,0.00009507292597313525,0.00009373252190613401,0.00009239213406342687,0.00009105281281103061,0.00008971556908324817,0.0000883814034614977,0.00008710665495680428,0.00008573741449117808,0.00008442061828356858,0.00008311105645301771,0.00008180965126677424,0.0000805173243813955,0.00007923496193503909,0.00007796342201101049,0.00007670354730336135,0.00007545614797591233,0.00007422200995881621,0.00007304759403764945,0.00007180453244288796,0.00007061632364133373,0.00006944449308739384,0.00006828971769001973,0.00006715264483814346,0.00006603389514012565,0.00006493405798992117,0.00006385369755628843,0.00006279334846364846,0.00006178216145463041,0.00006074856858300395,0.00005974337662498478,0.0000587692063088628,0.00005781746127420976,0.000056888524407723587,0.000055982749755534154,0.0000551004629629969,0.00005424196536383184,0.00005340752087240482,0.000052619669507677155,0.00005181626752398197,0.00005105617578301443,0.00005033208339590479,0.00004960983795328999,0.00004892533577745672,0.00004826621133041766,0.00004763253588730849,0.000047024379340425326,0.00004644177303001421,0.00004590346715778306,0.00004535692838179145,0.000044851617662607436,0.000044371878181071434,0.00004391764894285172,0.000043488854338226094,0.00004309969761084241,0.00004270538894248085,0.00004235240413470062,0.00004203841924439774,0.00004172371539368836,0.000041445402354753255,0.00004119151377566916,0.00004096184294088201,0.000040756175989378446,0.00004057425617366018,0.00004041585841149719,0.00004029018387210713,0.00004017039299743337,0.00012024376333098685,0.00009607719300179832,0.00009592286064431968,0.00009586901325127678,0.0000958667646741052,0.00009591535863518964,0.00009603013046624221,0.00009616486596782799,0.00009636158717113864,0.00009660590927944329,0.00009689697376224949,0.00009723390776841291,0.00009761582507266315,0.0000980418269077779,0.00009852322990400963,0.00009908095305234403,0.00009957084065965933,0.00010016529801490971,0.00010079917499808393,0.00010147153356309939,0.0001021814286268223,0.00010292790873914394,0.00010371965013965845,0.00010452864436410585,0.00010537949419710188,0.00010626302800829094,0.00010717842874873437,0.00010812467593158282,0.00010910079906158941,0.00011011249307864338,0.00011121138069830329,0.00011219084875677676,0.00011327815779253568,0.0001143903980609043,0.00011552668136514857,0.00011668585083314726,0.0001178719718231806,0.00011907053049400595,0.0001202933022475909,0.00012153532363993889,0.00012279565259741708,0.00012407334979066458,0.00012536747888480663,0.00012668070900472743,0.00012800209867800703,0.00012933996241334684,0.00013077694164775417,0.000132041214959524,0.00013341619570255602,0.00013480334971333353,0.0001361952405223397,0.00013759716652044648,0.0001390063033776042,0.0001404217811076044,0.00014184287316268619,0.00014326985430531886,0.00014469792590286783,0.00014613021779058132,0.00014756458101909136,0.00014900017677254394,0.0001504361720315287,0.0001518728211846715,0.0001534214512840071,0.00015472138932651875,0.00015615314628285274,0.0001575811491813039,0.00015900404705893034,0.00016042245547587814,0.00016183325943971115,0.00016323773549208257,0.00016463450206540253,0.0001660228223967663,0.0001674019660778414,0.00016877177080929718,0.0001701299490769471,0.0001714775630630842,0.00017281253875025843,0.00017413511901072842,0.000175444295281675,0.00017673981164260762,0.00017813890780735194,0.00017926436079649118,0.00018051639414780365,0.00018175131178549175,0.0001829687996526032,0.00018416753139814955,0.00018534764212497446,0.00018650872827303264,0.00018764905318401025,0.00018876928905130493,0.0001898686864484047,0.0001909461248980574,0.00019200163771415746,0.00019303453863245677,0.00019404432626366624,0.0001950306503661284,0.00019599263856749245,0.00019707454775463545,0.0001978129321352686,0.0001987050116010263,0.00019957104600743926,0.00020040983695996826,0.00020122132872325206,0.00020200514040388028,0.00020276097452014315,0.00020348860511528464,0.00020418756179785584,0.00020485773863914791,0.00020549880970637392,0.00020611051187491427,0.00020669341984709538,0.00020724474024153735,0.00020776685916428167,0.0002084161593411229,0.00020867006153390676,0.0002091140887130868,0.0002095242190493713,0.00020990081370751647,0.00021024409915315837,0.00021055430894174345,0.00021083167984213623,0.0002110763337498721,0.0002112896213062495,0.00021146820543167452,0.00021161577970989912,0.00021177413153901467,0.0002117737465228832,0.00021186295739863563,0.00021185426995591887,0.0002117477356598256,0.0002119843427011305,0.0002117509471964412,0.00021164194249976382,0.00021150065956708258,0.00021132697887005081,0.00021112223098225205,0.00021088160381779083,0.0002106097024400482,0.00021030465324075245,0.00020996619938276785,0.0002095940932537676,0.00020940103980408327,0.00020883186650446408,0.00020838153019209985,0.00020790122417120084,0.00020739118127350556,0.00020685164641858105,0.00020628287581559386,0.00020568723072835352,0.0002050584679358293,0.00020440358821731877,0.00020372055217112735,0.00020300963804503538,0.0002022711377216788,0.0002015053392526099,0.0002007125352477755,0.0001998930144186369,0.0001992223916812575,0.0001982184678718258,0.0001973293598888353,0.00019641609858057863,0.00019548220845854225,0.0001945186394736508,0.0001935356661089536,0.00019253037409816697,0.00019150324102861692,0.00019045474805498328,0.00018938538217255093,0.00018829563315931312,0.00018718599665913348,0.0001860569699480349,0.00018490905326384096,0.00018374274742120056,0.0001825585557269545,0.0001814962356647625,0.00018017028975274486,0.00017893543762360542,0.00017769003913631627,0.0001764299745418015,0.0001751558150955592,0.00017386813336080329,0.00017256750403437792,0.0001712545021668442,0.000169929703363534,0.00016859368264124318,0.00016724701486114083,0.0001658902732730889,0.00016452402949405866,0.00016314885250765987,0.00016176530881540193,0.00016037959926275768,0.00015897485026493532,0.0001577014518249909,0.00015618055594146781,0.00015476687447544998,0.00015334854630167654,0.00015192614543797458,0.000150500241791606,0.0001490714009246488,0.00014764018350213627,0.0001462071451243006,0.00014477283571733322,0.00014333779916589687,0.00014190257303390842,0.00014046768803010465,0.00013904154020764117,0.00013760030222403387,0.00013616961368055196,0.0001347413081168278,0.00013342903415568223,0.00013191128614408173,0.00013049543546078899,0.0001290841611126416,0.00012767794374783615,0.00012627725557966678,0.00012488256008242352,0.0001234943117443479,0.00012211295584660975,0.00012073892818667728,0.00011937265485484854,0.00011801455198024185,0.00011667561902946442,0.00011532348698788828,0.00011399237483415327,0.00011275125793147696,0.00011137153899269946,0.00011007224786234789,0.00010878392027215234,0.00010750690343801526,0.00010624153412810027,0.00010498813854520999,0.00010374703222828363,0.00010251851994296768,0.00010130289558519677,0.00010010044209360607,0.00009891143135604981,0.00009773612412619058,0.0000965747699459854,0.00009544141318125883,0.00009435651051213722,0.0015410546033438547,0.0019376417600816033,0.0019340188622036555,0.0019304471206876505,0.001926927148104157,0.0019234595215630898,0.0019200447827685744,0.0019166834380908572,0.0019133759586399824,0.001910122780356011,0.0019069243041100214,0.0019037808958078542,0.0019006928865057458,0.0018978178985484908,0.0018947059971029358,0.00189185309495209,0.0018889216753470504,0.0018861183577540382,0.0018833720313962204,0.0018806828265197542,0.0018780508423388881,0.001875476147370725,0.001872958779779961,0.001870498747720016,0.0018680960296823315,0.0018657505748450513,0.0018634623034217278,0.0018613588072677507,0.0018590741094486201,0.0018569587595089244,0.0002391969753018498,0.00023719506937883863,0.00023524956680360523,0.0002333602223884424,0.00023160702022595426,0.00022974103079746578,0.00022801916671967256,0.00022635218570317645,0.00022473973162007296,0.00022318142635251149,0.00022177481068701404,0.00022023869803533693,0.00021884195660163775,0.00021749781847328278,0.0002162058199126499,0.00021496547932320183,0.0002137762977578943,0.0002126377594203788,0.00021154933216081497,0.00021051046796211723,0.00020952060342012765,0.00020857916021228031,0.00020775625037368505,0.00020695760232203092,0.00020603883406745298,0.00020528731253355688,0.0002045811668910887,0.0002039197590015369,0.00020330243958856543,0.00020272854872005025,0.00020219741628382847,0.0002017083624486645,0.00020126069811659525,0.00020090152734919707,0.00020049308570860652,0.0002001661498489666,0.00019987785105505772,0.00019962746920488495,0.00019941427816311957,0.00019923754620504344,0.0001990965364262411,0.00019899050714393228,0.00019891871228610786,0.0001988804017680466,0.00019900659307678584,0.00019892573761086935,0.00019895117184799422,0.00019904111067372044,0.00019916069388297848,0.00019930917037825596,0.00019948578742124697,0.00019968979098903736,0.00019992042611652046,0.00020017693722783412,0.0002004585684554511,0.00020079013242645403,0.00020109755654328736,0.00020145043285914647,0.00020182545656197915,0.0002022218796553072,0.00020263895597564976,0.00020307594146288494,0.00020353209441992303,0.00020400667576362416,0.0002044989492637925,0.00020500818177313136,0.0002057092602037907,0.0002060591402477982,0.00020661711682091392,0.0002071890146114945,0.00020777413709334455,0.0002083717914118357,0.0002089812886151345,0.00020960194387503668,0.0002102330766988311,0.00021087401113122872,0.00021153853714905106,0.000212184521148008,0.00021285109053709633,0.00021352483415629307,0.0002142051043245938,0.0002148912591849148,0.0002155826628617802,0.00021627868561082886,0.0002169787039606825,0.00021769166192503743,0.0002183895441922742,0.000219098033576339,0.0002198081086898505,0.0002206921312687264,0.00022120765260581443,0.0002219217126125866,0.00022263476748457956,0.00022334628246303533,0.00022406227370884568,0.0002247634649522724,0.00022546732301369565,0.00022616757574060674,0.00022686372072020763,0.00022755526226266024,0.00022824171153073186,0.00022892258666250062,0.0002295974128874754,0.00023027035254778993,0.0002309276830172896,0.00023158166649905402,0.0002322277845726798,0.00023286560050420177,0.00023349468532095008,0.0002341146178915699,0.0002347249850010871,0.00023532538141940993,0.0002361035041092607,0.00023646433082966876,0.00023703700200558624,0.00023759762171158262,0.0002381458796020593,0.00023868147000731524,0.0002392040920944448,0.00023971345002706698,0.00024020925312428994,0.00024069375452181915,0.00024115940560603206,0.0002416128987890499,0.00024205173452043036,0.00024247565083150064,0.00024288439188094538,0.00024327770810082244,0.0002436553563365343,0.00024401882354070344,0.00024436294670873097,0.00024469222921075424,0.00024500494169669735,0.0002454876725681069,0.0002455315653291752,0.0002458038499392543,0.00024605696840543297,0.0002462921566969719,0.00024650601254158226,0.00024670185087243126,0.00024687864002435043,0.00024703639562308286,0.00024717512745641953,0.00024729483922101035,0.0002473955282887397,0.000247478041493676,0.00024753991465455193,0.0002477995502345465,0.00024746047865947986,0.00024755507962269326,0.0002475889425133554,0.00024756197177235983,0.0002474741026473992,0.0002473259260230689,0.00024751209612876025,0.0002472404289528609,0.00024711015757277583,0.00024696018797326354,0.00024679041562531724,0.0002466007284957542,0.0002463914154540251,0.0002461611827907767,0.00024591101316541166,0.0002456404083572376,0.00024534922041892493,0.000245037294634834,0.00024470446970486685,0.000244350577946632,0.0002439757567071928,0.00024387822575632195,0.00024324834784729933,0.00024282766103052427,0.00024238795111709792,0.00024192929371697622,0.00024145176891140653,0.00024095567260243203,0.00024044048882433897,0.00023990688757257177,0.00023935477963787775,0.00023878426384065052,0.00023819544197856626,0.00023758841856573573,0.00023696344709937147,0.00023632021844184487,0.00023565924361645631,0.00023498050755819518,0.00023428412443552918,0.00023357020954483632,0.00023283887904574583,0.0002320903529998103,0.00023157382083559418,0.00023058771892504816,0.00022979493662360343,0.0002289861754709226,0.00022816162784582917,0.00022732148957061923,0.00022646603384206496,0.0002255952514997873,0.00022470954966203195,0.00022380907172120395,0.00022289402817765144,0.00022196463192968916,0.0002210211451205728,0.0002200636508044463,0.00021909249601141846,0.00021810786046492936,0.00021710996622715221,0.0002160990366036286,0.00021507529594140862,0.00021403900427360262,0.00021299028810048632,0.00021192946850017393,0.0002108567416585103,0.00020999173655421942,0.00020870849286828665,0.00020760543634770656,0.00020649175390367378,0.00020536776685287352,0.00020423371587756397,0.00020308986234491498,0.00020193646839384755,0.00020077379678730886,0.0001996021281716913,0.0001984216765403525,0.00019723275294144098,0.0001960356060483019,0.00019483049950182725,0.00019361769665981907,0.00019239747214630772,0.00019117005497163207,0.00018993573849144136,0.00018869477323655117,0.00018744741880840252,0.0001861939335811565,0.00018493458251479366,0.00018383920777261496,0.00018242107606264757,0.00018114808633600584,0.00017987047287862653,0.00017858850257371616,0.00017730244664922155,0.0001760125539154088,0.00017471910235884443,0.0001734223488004052,0.00017212255320505883,0.00017081997381455724,0.00016951487087809062,0.00016820748792463475,0.0001668980877642004,0.0001655869173025903,0.00016427422448069687,0.0001629602548442941,0.00016164525415243052,0.00016032945510034493,0.0001590131027453547,0.00015769642960066242,0.00015637966757782915,0.0001552056835228855,0.00015376356979895708,0.0001524496581595605,0.00015113671639727783,0.00014982497090080204,0.00014851464692246008,0.00014720596804163573,0.0001458991502159414,0.0001445944131056515,0.00014329196894433152,0.00014199202784531255,0.00014069479668710067,0.0001394004799384286,0.00013810927528724455,0.00013682138192012923,0.00013553699236113585,0.00013425629634374696,0.00013297947998269774,0.00013170672637177256,0.00013043821233702822,0.00012917411455274977,0.00012803214693186659,0.0001266728657127645,0.00012542432367377158,0.0001241809714458086,0.00012294297391672894,0.00012171049086768812,0.00012048367882465722,0.00011926269065630439,0.00011804767588081158,0.00011683877907662335,0.00011563614286856175,0.00011443990500396499,0.00011325019971151039,0.0001120671576658699,0.00011089090489056159,0.00010972156478207988,0.00010855925609682182,0.00010740409396435172,0.00010625618971098024,0.0001051156503179565,0.00010407810362426177,0.00010286722157634987,0.0001017503594393544,0.00010064133668307777,0.00009954024734243124,0.00009844718173596276,0.00009736222695785233,0.00009628546651437205,0.00009521698035821761,0.00009415684494291336,0.00009310513333704618,0.00009206191515789154,0.0000910272569530483,0.0000900012213144231,0.00008898386845270764,0.00008797525409034811,0.0000869754323641424,0.00008598445246331777,0.00008507158618218736,0.00008403640156554192,0.00008307290239869562,0.00008211847509616837,0.00008117315850781317,0.00008023699242041177,0.00007931000997387294,0.00007839224794607344,0.00007748373409563549,0.00007658450219578485,0.0000756945806700812,0.0000748139933707629,0.00007394277281138606,0.00007308093717126343,0.00007222851887860378,0.00007138554295511293,0.00007055202806872612,0.00006972801264567156,0.00006896789456750496,0.00006811409663252378,0.00006731925135728874,0.00006653405569838915,0.00006575857580164283,0.00006499282468142184,0.00006423688288312072,0.000063490806140423,0.00006275462559155533,0.00006202846828100758,0.0000613123414502907,0.00006060640327585922,0.00005991075464198809,0.00005922543416457735,0.000058550658564539694,0.000057886572079318685,0.0000572710488418912,0.00005659477476492838,0.00005596409682332408,0.00005534479282334616,0.000054737272995770576,0.00005414182142863683,0.00005355856599201669,0.00005298806694942082,0.000052430710693772046,0.000051886658604457766,0.00005135667382943023,0.000050841273208419196,0.00005034064087696006,0.000049855815393771535,0.000049387477402990587,0.00004893580336099279,0.00004853029456516269,0.00004809039832510293,0.00004769509610618113,0.000047320825895463605,0.000046968722963157386,0.000046638682251107276,0.00004633340586981793,0.00004605433638942553,0.00004580090421657366,0.000045576933290613315,0.00004538324119344727,0.00004522233917619806,0.00004509374313288994,0.00004500211261960619,0.00004494979865342786,0.00004493507083161408,0.00004498686504614624,0.00004504185453030672,0.00004516638329165031,0.000045338128590036885,0.00004556553691202489,0.000045849555888501044,0.00004619533734959383,0.000046599711938139524,0.00004707328580782703,0.00004761689475041628,0.000048236875507266,0.00004892828960214145,0.000049704699338820154,0.000050566433628106245,0.000051536513906410105,0.00005256276766634182,0.00005370571001342223,0.000054950672346747024,0.000056307487882674596,0.00005776248360540554,0.000059339993132672165,0.00006103681453660956,0.00006286577874929463,0.00006480332358503008,0.00006688448102681912,0.00006910170988821672,0.00007145902118417972,0.00007397028215844117,0.00007661726097003385,0.00007940806478788015,0.00008236293834405362,0.00008549228516063457,0.00008874187111633535,0.00009217714815329736,0.0000957763031940781,0.00009954103542157079,0.0001034958400747047,0.0001075652709962146,0.00011183422377025217,0.00011627051699407954,0.00012087352627536012,0.00012564204375579106,0.0001306064410427452,0.00013566158380208673,0.00014091525674436172,0.00014632290315753118,0.00015188024388058266,0.00015761963381525444,0.00016341232641213572,0.00016938903300951134,0.00017549040719786705,0.00018170879060424048,0.00018803577566568476,0.00019450739631182395,0.00020096443202039709,0.00020756942472668276,0.00021422994546799328,0.00022095100433580035,0.00022771494326361214,0.00023456893019243205,0.0002413000184481301,0.0002481185976255301,0.00025492354006910364,0.00026170029477724744,0.00026843384779630717,0.00027510879469068764,0.00028176856924781393,0.00028820301283071994,0.00029461005571583115,0.00030089605088908026,0.00030704164930754315,0.00031303105457357083,0.00031884849347423494,0.000324538020622212,0.0003298812689227967,0.0003350985419892474,0.00034007988006769344,0.0003448118235019,0.0003492812302660616,0.00035357785475939845,0.00035733644826360493,0.00036096364868095553,0.00036427373515000644,0.0003672590281071046,0.00036991211795921164,0.00037222601910239943,0.0003742472035556223,0.0003757741237750487,0.0003770595182074269,0.00037796988118038926,0.00037853989881363046,0.0003786485904929047,0.00037849640258063547,0.0003779299721288551,0.00037700057536735305,0.0003756973384548314,0.0003741258171912191,0.000372092097293964,0.00036975107134324634,0.00036706886690811,0.00036405234603938325,0.0003607088682215623,0.0003570461550333146,0.0003532266346456946,0.0003489021751633146,0.0003443873018618767,0.00033960803994830446,0.00033457840362921114,0.00032931318252491144,0.0003238279836592079,0.00031827470111957387,0.0003123379950716162,0.0003063287778147931,0.0003001843482866304,0.0002939312880959559,0.00028759530536510687,0.0002812928198370084,0.00027485811393764535,0.00026851483621329975,0.00026226310170808606,0.000256166212428895,0.00025029903779469185,0.0002447529555077461,0.00023971366672978508,0.00023510543216891913,0.0002312625700014137,0.00022830502865202627,0.00022644955622160167,0.00022593375259952108,0.00008569687785939885,0.00008669649289825952,0.00008847772861675216,0.0000911542075941578,0.00009486654565442103,0.00009978016128752333,0.00010606758823875735,0.00011384840753666724,0.0001233569663791413,0.00013472228899587803,0.00014813697649491576,0.00016371690311877484,0.00018163609395939657,0.00020191767083306913,0.0002246942551773521,0.0002499260443059647,0.00027762362539320186,0.00030764221586963944,0.00033985851085592935,0.0003739849005389983,0.0004098086477313306,0.0004468350161267303,0.0004847898689297511,0.0005229441501930798,0.0005609678733065982,0.0005981953790768997,0.0006339094944866625,0.0006676956139819073,0.0006986074083383235,0.0007263929027475166,0.0007503688121723541,0.0007699296429180244,0.0007849377553683488,0.0007946955201387467,0.0007994356674061992,0.0007988074279681395,0.0007929200221688183,0.0007819252590575977,0.000766106101407795,0.0007460104557340693,0.000721925322909132,0.0006946250204083048,0.0006649777963633774,0.0006334016466844265,0.0006010893972630631,0.000568671392982673,0.0005371330107036778,0.000507390860380067,0.0004800011626824692,0.0004559016869011092,0.000435486361140882,0.0004193169136648844,0.0004075144983174614,0.0004002422491749342,0.0003972322802895513,0.0003981374844418484,0.0004023619023124321,0.00040910674559353473,0.00041745127287612393,0.00042637992063079946,0.0004347155622433885,0.00044158398635533704,0.0004458277490186707,0.0004467890238449704,0.0004437419954837733,0.0004363535360536877,0.00042453451667220996,0.0004083805094233612,0.00038848097326885306,0.0003653961637836541,0.0003401748612499293,0.00031405354841432254,0.0002884337539425668,0.0002650845634500416,0.0002458924577334644,0.0002330731986514245,0.000229039663523446,0.000236251515373762,0.0002572166748822254,0.000294037943438786,0.00034823854743550313,0.0004202903435165471,0.000509244970909464,0.00061244170684586,0.0007253497966329721,0.0008417159808305412,0.000953882719902488,0.001053789500210769,0.0011333611962970195,0.0011859472803007983,0.001207046226117354,0.0011950106650622135,0.0011513337100480675,0.0010805441843998135,0.0009899390609775806,0.0008882275547303265,0.0007851816990222221,0.0006902207055947948,0.0006115422964491683,0.0005553680657569246,0.0005253228761373288,0.0005221246409141761,0.0005435157353373638,0.000584486995270302,0.0006378022556343872,0.0006948108447187425,0.0007464682110560137,0.0007844365935101796,0.0008023754530849605,0.0007963445006621649,0.0007655859674844549,0.0007122694593908978,0.0006411020743142811,0.0005581730765575128,0.0004702455988640939,0.0003836021157665241,0.00030334407747341575,0.00023296950135944384,0.0001742866355272596,0.00011261208280240648};
		Histogram h = new Histogram(values);
		RNG.init();
		double sum = 0;
		for(int i = 0; i < values.length; i++) {
			sum += values[i];
		}
		System.out.println(sum);
		System.out.println(h.getPrecomputedBin());
		System.out.println(h.getPrecomputedBin());
		System.out.println(h.getPrecomputedBin());
		System.out.println(h.getPrecomputedBin());
	}
	
}
